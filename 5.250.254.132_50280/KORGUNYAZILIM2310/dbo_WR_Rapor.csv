Rapor_Id,Komut,Comment,Rapor,kgid,insUN,insDT,insApp,updUN,updDT,updApp
1,D1,Dee,"select     k.CariKod , (case substring(k.SipTip,2,1) when 'D' then (Select LName From Location l Where l.location=k.CariKod) when 'T' then isnull((select top 1 Ad from st_firma_kart ff Where ff.fkod=k.CariKod),cr.CName) else cr.CName end)  as CariKod_Tanim ,isNull(h.Miktar,0)  as Siparis_Miktari ,h.Birim , (case when (isnull(k.Durum,'')='*') or (isnull(h.Durum,'')='*') then isnull(h.Miktar,0) else  (select sum(Cikan) from si_gchar xx  Where (xx.SKod=h.SKod) and (xx.FisNo=h.SipNo) and(xx.FisHarInx=h.SipHarinx) and (isnull(xx.giren,0)>0) and (Modul=N'i') ) end) as Toplam_Kapatilan  ,isnull((select sum(isnull(cxx.Miktar,0) ) From Fatura_Har cxx   Where (cxx.SipHarinx=h.SipHarinx)),0) as gonderilen  , isnull((select Sum(isnull(cxx.cikan  ,0)) From (fatura_kay mfat join Fatura_Har fat on mfat.BelgeNo=fat.BelgeNo)  Left Outer join S_GcHar cxx on (fat.skod=cxx.skod) and (fat.BelgeNo=cxx.FisNo)and(fat.FatHarinx=cxx.FisHarInx) Where (cxx.Modul='F')and(fat.SipHarinx=h.SipHarinx) and ((mfat.fatura='*')or(mfat.belgeno in (select irsNo From fatirs) )) ),0) as Faturalanan  , (select sum(isnull(sgc.Cikan,0)-isnull(sgc.giren,0) ) From sevk_M sm left outer join Sevk_D sv on (sm.SevkNo=sv.SevkNo) left outer join sevk_gchar sgc on (sv.SevkNo=sgc.FisNo)and(sv.SevkHarinx=sgc.FisHarinx)  Where (sv.SipHarinx=h.Sipharinx) and ((isnull(Durum,'')='') or (isnull(Durum,'')='B')) and ((isnull(sgc.Cikan,0)-isnull(sgc.giren,0))>0)  ) as Sevke_emri_verilen  , (select sum(isnull(sgc.Cikan,0)-isnull(sgc.giren,0) ) From sevk_M sm left outer join Sevk_D sv on (sm.SevkNo=sv.SevkNo) left outer join sevk_gchar sgc on (sv.SevkNo=sgc.FisNo)and(sv.SevkHarinx=sgc.FisHarinx)  Where (sv.SipHarinx=h.Sipharinx) and ((isnull(Durum,'')='') or (isnull(Durum,'')='B')) and ((isnull(sgc.Cikan,0)-isnull(sgc.giren,0))>0)  ) as Sevke_emri_verilen2  From Siparis_Kay k Join Siparis_Har h on k.SipNo=h.SipNo  Left Outer Join StokKart st on (st.Skod=h.skod)  Left Outer Join Cari_Kart cr on (cr.CKod=k.CariKod)  Left Outer Join Cari_Adres ca on (ca.Ckod=k.CariKod and ca.AdresTanim=k.AdresAdi)  Where  (isNull(cr.Pasif, '')='')  AND  (isNull(cr.KaraListe, '')='')  AND  (k.Location in ('PA001'))  AND  ((k.Durum='')or(k.Durum is Null)) and ((h.Durum='')or(h.durum is null))  AND  ( (k.SipTip = 'S') or (k.SipTip = 'SD'))  AND  (h.skod in (Select stk.skod From StokKart stk join CoLoSo c on stk.skod=c.skod  Where  (isNull(stk.Pasif, '') = '') ))
",1,,,,,,
